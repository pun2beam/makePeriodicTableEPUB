<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{{ cover_width }}" height="{{ cover_height }}" viewBox="0 0 {{ cover_width }} {{ cover_height }}">
  <style>
    text { font-family: 'Helvetica Neue', Helvetica, Arial, 'Noto Sans', 'DejaVu Sans', 'Noto Sans CJK JP', 'Noto Sans JP', sans-serif; }
    .title { font-size: 72px; font-weight: 700; letter-spacing: 4px; text-anchor: middle; }
    .subtitle { font-size: 36px; font-weight: 400; text-anchor: middle; }
    .cell { fill: #fdfdfd; stroke: #000; stroke-width: 2; }
    .symbol { font-size: 82px; font-weight: 900; text-anchor: middle; dominant-baseline: middle; }
    .atomic-number { font-size: 28px; font-weight: 600; }
  </style>
  <rect x="0" y="0" width="{{ cover_width }}" height="{{ cover_height }}" fill="#ffffff"/>
  <g transform="translate({{ cover_width / 2 }}, {{ cover_height / 2 }}) rotate(-90) translate({{ -layout_width / 2 }}, {{ -layout_height / 2 }})">
    <defs>
      <path id="arcTitle" d="{{ arc_title_d }}" fill="none" stroke="none"/>
      <path id="arcSubtitle" d="{{ arc_subtitle_d }}" fill="none" stroke="none"/>
    </defs>

    <text class="title">
      <textPath href="#arcTitle" xlink:href="#arcTitle" startOffset="50%" text-anchor="middle">
        元 素 周 期 表
      </textPath>
    </text>

    <text class="subtitle">
      <textPath href="#arcSubtitle" xlink:href="#arcSubtitle" startOffset="50%" text-anchor="middle">
        Reference Edition for Kindle
      </textPath>
    </text>
    <defs>
      <!-- 電子の見た目を再利用化 -->
      <g id="e10"><circle class="electron" r="10" cx="0" cy="0"/></g>
      <g id="e9"><circle class="electron" r="9"  cx="0" cy="0"/></g>
    </defs>

    <g id="atom" transform="translate({{atom_x}}, {{atom_y}})">
      <circle class="nucleus" cx="0" cy="0" r="48"/>
      <circle class="ring" cx="0" cy="0" r="80"  fill="none" stroke="#000" stroke-width="3"/>
      <circle class="ring" cx="0" cy="0" r="120" fill="none" stroke="#000" stroke-width="3"/>
    
      <!-- K殻（r=80） -->
      <use href="#e10" transform="rotate(0)   translate(80,0)"/>
      <use href="#e10" transform="rotate(180) translate(80,0)"/>
    
      <!-- L殻（r=120） -->
      <use href="#e9" transform="rotate(0)   translate(120,0)"/>
      <use href="#e9" transform="rotate(45)  translate(120,0)"/>
      <use href="#e9" transform="rotate(90)  translate(120,0)"/>
      <use href="#e9" transform="rotate(135) translate(120,0)"/>
      <use href="#e9" transform="rotate(180) translate(120,0)"/>
      <use href="#e9" transform="rotate(225) translate(120,0)"/>
      <use href="#e9" transform="rotate(270) translate(120,0)"/>
      <use href="#e9" transform="rotate(315) translate(120,0)"/>
    </g>
    {% for cell in cells %}
    <g transform="translate({{ cell.x }}, {{ cell.y }})">
      <rect class="cell" width="{{ cell.width }}" height="{{ cell.height }}" rx="12" ry="12"/>
      <text x="20" y="36" class="atomic-number">{{ cell.atomic_number }}</text>
      <text x="{{ cell.width / 2 }}" y="{{ cell.height / 2 + 10 }}" class="symbol">{{ cell.symbol }}</text>
    </g>
    {% endfor %}
  </g>
</svg>
